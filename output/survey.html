<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" integrity="sha384-IS73LIqjtYesmURkDE9MXKbXqYA8rvKEp/ghicjem7Vc3mGRdQRptJSz60tvrB6+"
 rel="stylesheet" />
<!-- The following snippet enables the 'responsive' behavior on smaller screens -->
<meta content="width=device-width,initial-scale=1" name="viewport" />
<!-- Instructions -->

<!-- generated by MTurk Template Generator, a tool created by Morris Alper (2013) -->
<!-- available at http://mturk.mit.edu/template.php -->

<script>
	//written by Morris Alper -- January 2013
	//you may copy with attribution

	//Navigation.js: provides functionality for multi-page surveys

	var current = 1; //the current page

	var moved = []; //pages which have been moved by the randomization
	var movedto = [];

	//takes randomization into account
	function effectivePage(pagenum) {
		var index = moved.indexOf(pagenum);
		if (index == -1) {
			return pagenum;
		} else {
			return movedto[index];
		}
	}

	var numberText = []; //stores divs which need to be updated when the page changes
	var pntexts = []; //texts in them
	function makePageNumber(text) { //text: something like "Page 1 / 4"
		var temp = text.split(1);
		var texts = [temp[0], temp[1]];
		//the following is needed if there are more 1's (e.g. if the total # of pages contains the digit 1)
		if (temp.length > 2) {
			for (var i = 2; i < temp.length; i++) {
				texts[1] += 1 + temp[i];
			}
		}
		document.writeln("<p><div id='pagenumberdiv" + numberText.length + "'></div></p>");
		loadPageNumber(("pagenumberdiv" + numberText.length), texts);
	}
	function loadPageNumber(id, texts) {
		var newone = document.getElementById(id);
		numberText.push(newone);
		pntexts.push(texts);
		updatePageNumbers();
	}
	function updatePageNumbers() {
		for (var i = 0; i < numberText.length; i++) {
			numberText[i].innerHTML = pntexts[i][0] + current + pntexts[i][1];
		}
	}

	//make one vanish and the other appear
	function swap(vanish, appear) {
		document.getElementById(vanish).style.display = "none";
		//document.getElementById(appear).style.display = "inline";
		document.getElementById(appear).style.display = "block";
		updatePageNumbers();
	}

	//go to the next page
	function next() {
		current++;
		swap(effectivePage(current - 1), effectivePage(current));
	}

	function back() {
		current--;
		swap(effectivePage(current + 1), effectivePage(current));
	}

	//shuffles the array
	//taken from http://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array-in-javascript
	Array.prototype.shuffle = function () {
		for (var i = this.length - 1; i > 0; i--) {
			var j = Math.floor(Math.random() * (i + 1));
			var tmp = this[i];
			this[i] = this[j];
			this[j] = tmp;
		}

		return this;
	}

	//randomize the order of trials i through j
	//note: don't call this on the same index twice!
	function randomize(i, j) {
		ar = [];
		ar2 = [];
		for (var k = i; k <= j; k++) {
			ar.push(k);
			ar2.push(k);
		}
		ar2.shuffle();
		for (var k = 0; k < ar.length; k++) {
			if (moved.indexOf(ar[k]) != -1) {
				alert("Error: same index randomized twice.");
			} else {
				moved.push(ar[k]);
				movedto.push(ar2[k]);
			}
		}
	}
</script>

<style type="text/css">
	.wrapper {
		height: 80%;
		width: 100%;
		display: table;
	}

	.page {
		vertical-align: middle;
	}

	.cell {
		margin: 0 auto;
		padding: 10px;
		width: 100%;
	}

	#pagenum {
		text-align: center;
		font-style: italic;
	}

	.disclaimer {
		font-weight: bold;
		color: #555555;
	}

	.warning {
		font-weight: bold;
	}

	body {
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
	}

	.cover {
		margin-left: auto;
		margin-right: auto;
		text-align: center;
	}
	
	#timer { 
		font-size: 24px;
		margin-right: auto;
		margin-left: auto;
		text-align: center;
	}
	
	.obj {
		position: absolute;
	}
	
	label {
		padding: 8px;
		text-align: center;
		cursor: pointer;
	}

	.checkboxgroup {
		text-align: center;
		display: inline-block;
		width: 60px;
	}

	.checkboxgroup label {
		display: block;
	}

	.arrow_label {
		width: 50px;
		margin-bottom: 10px;
	}

	.comment {
		width: 100%;
	}
</style>

<script>
	function submitPage(evt) {
		evt.preventDefault();
		next();
		return false;
	}

	function validatePage(event, num) {
		radios = document.querySelectorAll("input[class='reqinp" + num + "']")
		has_all_checked = Array.from(radios).filter(radio => radio.checked).length == 4
		if (!has_all_checked) {
			alert("Please fill in all arrow ratings.");
			return;
		} 
		
		comment = document.querySelector("input.reqcomm" + num)
		if (comment.value == "") {
			alert("Please fill in a brief comment.")
			return;
		} else {
			next();
		}
	}

	function post() {
		// Check that worker ID is not empty
		var text = document.getElementById("workerID").value;
		if (text === "") {
			alert("please fill in your worker ID.");
			return;
		}
		
		// Disable input
		var button = document.getElementById("workerIDSubmit").disabled = true;
		
		// Check worker id
		var id = document.getElementById("workerID").value;
		checkWorkerID(id);
	}

	function callback(responseText) {
		var divId = "";
		if (responseText == '"NAME ADDED"') {
			divId = "callback_success";
			document.getElementById("start_study").disabled = false;
		} else if (responseText == '"NAME ALREADY EXISTS"') {
			divId = "callback_fail";
		} else {
			divId = "callback_error";
		}
		
		document.getElementById(divId).style.display = "block";
	}

	function checkWorkerID(id) {
		xhr = new XMLHttpRequest();

		xhr.open('POST', 'https://script.google.com/macros/s/AKfycby4OXmrqCnCxyUvoGjNPEyeTDMG0wXqmqmwAy_dgOvlMhY8Ojka/exec');
		xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xhr.onload = function() { // when the request is loaded
			callback(xhr.responseText);// we're calling our method
		};
		xhr.send(encodeURI('name=' + id));
	}

	function preventEnter(event) {
		if (event.keyCode == 13) {
			event.preventDefault();
			return false;
		}
	}

	// randomize(1, 1); 
</script>

<div class="wrapper">

	<section class="container">
		<div class="page" id="1">
			<div class="cell">
			
				<div align="center"><h1>Arrow Comparison Study</h1></div>
			
				<br />
				<div>In this study, you will be shown a series of images of arrows and objects and asked to select the object that the arrow points to. You will also be asked to choose the arrow that points best to a certain object.</div>
				<br />

				<div class="warning">You will not be paid if your answers are not consistent. This study includes two repeated prompts. If you answer the repeated prompts very differently, your results will be rejected.</div>
				&nbsp;

				<div>Please only complete this HIT once. You will not be paid for retakes. If you have already completed this HIT and submit it again, all submissions but the first will be rejected, and you will only be paid for the first submission. Having a submission rejected is detrimental to your reputation as a worker, and may prevent you from completing HITs in the future.</div>
				<br /> 

				<label for="workerID">Please enter your worker ID here:</label>
				<input id="workerID" name="workerID" type="text" onkeydown="preventEnter(event)"/>
				<input id="workerIDSubmit" type="button" onclick="post()" value="Submit"/>
				<br />

				<div id="callback_success" style="display: none;">You are clear to participate in this survey.</div>
				<div id="callback_fail" style="display: none;">Sorry, you have already completed this survey. Please return the HIT.</div>
				<div id="callback_error" style="display: none;">Something went wrong. Please reload the page or try another browser.</div>

				<div>
					<br />
					<input id="start_study" onclick="next();" type="button" value="Continue" disabled="true"/>
				</div>
			</div>
		</div>

		<form>
			<div class="page" id="2" style="display: none">
	<div class="cell">
		<div class="row">
			<div class="col-md-12">
				<p style="margin-left: auto;margin-right: auto;text-align: center;"><b>Please review the image below.</b></p>
		
				<div class="img_ctnr" style="height: 400px;width: 400px;margin-bottom: 15px;margin: 0 auto;"><img alt="image_url" src="${image_url_1}" /></div>
			</div>
			
			<div class="col-md-12">
			<div class="form-group"><label class="group-label" style="margin-bottom: 15px;">Rate how well each arrow points at the target object.</label>
		
			<div class="prompt">
				<label class="arrow_label">
				Red: 
				</label>
				<div class="checkboxgroup">
					<label>Very Badly</label>
					<input autocomplete="off" class="reqinp1" name="radio_red1" required="" type="radio" value="1"/>
				</div>
			  
				<div class="checkboxgroup">
					<label>Badly</label>
					<input autocomplete="off" class="reqinp1" name="radio_red1" required="" type="radio" value="2"/>
				</div>
				
				<div class="checkboxgroup">
					<label>Neutral</label>
					<input autocomplete="off" class="reqinp1" name="radio_red1" required="" type="radio" value="3"/>
				</div>
				
				<div class="checkboxgroup">
					<label>Well</label>
					<input autocomplete="off" class="reqinp1" name="radio_red1" required="" type="radio" value="4"/>
				</div>
				
				<div class="checkboxgroup">
					<label>Very Well</label>
					<input autocomplete="off" class="reqinp1" name="radio_red1" required="" type="radio" value="5"/>
				</div>
			</div>  
		
			<div class="prompt">
				<label class="arrow_label">
				Blue: 
				</label>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_blue1" required="" type="radio" value="1"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_blue1" required="" type="radio" value="2"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_blue1" required="" type="radio" value="3"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_blue1" required="" type="radio" value="4"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_blue1" required="" type="radio" value="5"/>    
				</div>
			  </div>
		  
		  <div class="prompt">
				<label class="arrow_label">
				  Green: 
				</label>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_green1" required="" type="radio" value="1"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_green1" required="" type="radio" value="2"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_green1" required="" type="radio" value="3"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_green1" required="" type="radio" value="4"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_green1" required="" type="radio" value="5"/>    
				</div>
			  </div>
		  
		  <div class="prompt">
				<label class="arrow_label">
				  Purple: 
				</label>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_purple1" required="" type="radio" value="1"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_purple1" required="" type="radio" value="2"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_purple1" required="" type="radio" value="3"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_purple1" required="" type="radio" value="4"/>    
				</div>
				<div class="checkboxgroup">
				  <input autocomplete="off" class="reqinp1" name="radio_purple1" required="" type="radio" value="5"/>    
				</div>
			  </div>
		  
		  
		  	<br>
			<label for="Comment1">Write a brief comment about how you rated the arrows:&nbsp;</label> <input class="comment reqcomm1" autocomplete="off" name="Comment1" type="input" required="" value="" /></div>
			<input name="Continue1" onclick="validatePage(event, 1)" type="button" value="Continue" /><label for="Continue1" style="margin-left: 15px">1 of 4</label></div>
		</div>
	</div>
</div>

		</form>

		<div class="page" id="3" style="display: none;">
			<div class="cell">

				<p>Thank you for participating in this study!</p>
				<br />
				<input type="submit" value="Submit" />

			</div>
		</div>

	</section>
</div>

<!-- End Image Tagging Layout -->
<!-- Open internal style sheet -->
<style type="text/css">
	#collapseTrigger {
		color: #fff;
		display: block;
		text-decoration: none;
	}

	.image {
		margin-bottom: 15px;
	}

	.radio:first-of-type {
		margin-top: -5px;
	}

	.img_ctnr {
		position: relative;
	}

	.eval_img {
		position: absolute;
		top: 0;
		left: 0;
	}
</style>
<!-- Close internal style sheet -->
<!-- Please note that Bootstrap CSS/JS and JQuery are 3rd party libraries that may update their url/code at any time. Amazon Mechanical Turk (MTurk) is including these libraries as a default option for you, but is not responsible for any changes to the external libraries -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="
 crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js" integrity="sha384-s1ITto93iSMDxlp/79qhWHi+LsIi9Gx6yL+cOKDuymvihkfol83TYbLbOw+W/wv4"
 crossorigin="anonymous"></script>